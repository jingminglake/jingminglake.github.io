---
layout:     post
title:      RubyOnRails工具介绍
subtitle: 笔记
date: 2020-11-24
author: Jingming
status: public
catalog: true
tags:
    - Ruby
---

> https://juejin.cn/post/6844903745822670861<br/>
 https://www.codenong.com/6927442/<br/>

### 一、GEM

在 Ruby 中，如果想使用另外一个 Ruby 文件中的内容，需要使用 require 关键字来加载另外一个 Ruby 文件中的内容。

require 会在 Ruby 预设的 $LOAD_PATH 中去查找对应的文件。

可以通过执行 ruby -e 'puts $LOAD_PATH' 来看看当前 Ruby 中的 $LOAD_PATH 都有什么内容。

gem使用gemspec 来描述一个ruby文件包的元信息，gem把脚本打包成一个.gem文件，就相当于java打的.jar包。

执行gem install 文件名.gem，下载gem（也就是ruby文件包）到GEM_PATH中。

安装了GEM的环境，require不仅会在$LOAD_PATH 中查找文件，还会在GEM_PATH中找文件。

### 二、Bundler

GEM文件之间必然会出现版本依赖的问题，就像Java使用Maven管理包依赖，Ruby使用Bundle来解决GEM之间依赖管理。

使用Gemfile来规定所有需要下载的GEM（类似于Java的pom文件），执行bundle install来下载和安装GEM包，并把下载下来

的GEM包的版本记录在Gemfile.lock中。

Gemfile.lock与Gemfile不同。设计Gemfile.lock的原因是，Gemfile下载GEM包的时候与Java的Pom不同，

Gemfile指定的版本是模糊的，而不是具体版本，例如说大于某版本，这样的结果是，在不同时间下执行Gemfile，下载下来的GEM不同。。

因此设计了Gemfile.lock，bundle install的时候，会先查看Gemfile.lock，然后结合Gemfile来安装"最新"版本。

bundle exec作用是让当前执行ruby程序使用Gemfile.lock中的GEM版本，而不是$LOAD_PATH中的版本。

### 三、RVM

RVM的作用是让我们可以同时在多个版本的Ruby环境下工作。这好比Java开发时候，必须先选择一种JDK版本进行开发。

### 四、Ruby程序部署到Docker

先复制Gemfile到容器，然后执行bundle install，最后拷贝源码到容器。

而不是：拷贝Gemfile和源码，然后执行bundle install。

原因：Dockerfile里面的命令都会创建中间镜像层，且都会缓存下来，只有在当前命令使得镜像变化的时候才会生成新的镜像层并缓存；

如果Ruby项目的Gemfile不变，变的是源码，那么这个镜像构建过程会快很多。